<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Safe - Dashboard C·∫£nh B√°o S·ªõm</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #eef2f6;
        }
        .data-card {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="max-w-6xl mx-auto bg-white p-6 sm:p-8 rounded-xl shadow-2xl border-t-8 border-green-500">
        <!-- HEADER -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800">GREEN SAFE: H·ªÜ TH·ªêNG D·ª∞ B√ÅO TR·∫†NG TH√ÅI C√ÇY </h1>
            <p class="text-lg text-gray-500 mt-2">Gi√°m s√°t c√¢y M√£ s·ªë: CAY_HN_PHOCO_AX000001 | <span id="currentStatus" class="font-bold">ƒêang t·∫£i...</span></p>
        </header>

        <!-- MAIN GRID -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <!-- COLUMN 1: RISK SCORE (Tr·ªçng t√¢m) -->
            <div id="riskScoreCard" class="data-card p-6 rounded-xl text-white text-center shadow-lg lg:col-span-2 bg-gray-700">
                <p class="text-xl font-medium mb-2">ƒêI·ªÇM R·ª¶I RO ƒê·ªäNH L∆Ø·ª¢NG (AI SCORE)</p>
                <div class="flex items-center justify-center space-x-4">
                    <span id="riskScoreValue" class="text-6xl sm:text-8xl font-black">0.0</span>
                    <span id="riskLevelEmoji" class="text-6xl sm:text-7xl">üå≥</span>
                </div>
                
                <hr class="my-4 border-white/30">

                <!-- Time-to-Intervention (ƒêi·ªÉm m·∫°nh) -->
                <div class="mt-4 bg-white/10 p-4 rounded-lg">
                    <p class="text-lg font-semibold uppercase tracking-wider">TH·ªúI GIAN C√íN L·∫†I ƒê·∫æN NG∆Ø·ª†NG C·∫¢NH B√ÅO (20¬∞)</p>
                    <p id="timeToIntervention" class="text-4xl font-extrabold mt-1">ƒêang t√≠nh to√°n...</p>
                </div>
                
                <!-- H√ÄNH ƒê·ªòNG ƒê·ªÄ XU·∫§T -->
                <p id="suggestedAction" class="mt-4 text-xl font-bold p-2 rounded-lg bg-white/20">ƒêang theo d√µi...</p>
            </div>

            <!-- COLUMN 2: KEY PARAMETERS (C√°c Bi·∫øn s·ªë) -->
            <div class="lg:col-span-1 space-y-4">
                <div class="data-card bg-blue-100 p-4 rounded-xl">
                    <p class="text-lg font-semibold text-blue-800">G√ìC NGHI√äNG HI·ªÜN T·∫†I (Œ∏) </p>
                    <p class="text-4xl font-bold text-blue-600 mt-1"><span id="angleValue">0.00</span><span class="text-xl">¬∞</span></p>
                    <p class="text-sm text-gray-500 mt-1">R·ªßi ro Tƒ©nh (D√†i h·∫°n)</p>
                </div>
                <div class="data-card bg-red-100 p-4 rounded-xl">
                    <p class="text-lg font-semibold text-red-800">T·ªêC ƒê·ªò THAY ƒê·ªîI (RATE)  </p>
                    <p class="text-4xl font-bold text-red-600 mt-1"><span id="rateValue">0.00</span><span class="text-xl">¬∞/Gi·ªù</span></p>
                    <p class="text-sm text-gray-500 mt-1">R·ªßi ro ƒê·ªông (C·∫£nh b√°o S·ªõm) </p>
                </div>
                <div class="data-card bg-yellow-100 p-4 rounded-xl">
                    <p class="text-lg font-semibold text-yellow-800">T·ªêC ƒê·ªò GI√ì (WINDSPEED) - </p>
                    <p class="text-4xl font-bold text-yellow-600 mt-1"><span id="windValue">3.5</span><span class="text-xl">m/s</span></p>
                    <p class="text-sm text-gray-500 mt-1">T√°c nh√¢n Ngo·∫°i c·∫£nh (D·ªØ li·ªáu API m√¥ ph·ªèng)</p>
                </div>
                <!-- ƒê√£ lo·∫°i b·ªè card ƒê·ªô ·∫®m (Humidity) -->
            </div>
        </div>
        
        <!-- FOOTER / M√î PH·ªéNG -->
        <div class="mt-8 pt-4 border-t border-gray-300 text-center">
            <p class="text-sm text-gray-500">
                **ƒê√ÇY L√Ä CH·∫æ ƒê·ªò M√î PH·ªéNG (MOCK DATA) TR·ª∞C TI·∫æP**<br>
                M√¥ ph·ªèng d·ªØ li·ªáu Angle v√† Rate tƒÉng d·∫ßn theo th·ªùi gian ƒë·ªÉ k√≠ch ho·∫°t m√¥ h√¨nh c·∫£nh b√°o.
            </p>
        </div>
    </div>

    <script>
        // --- C√ÅC H·ªÜ S·ªê H·ªíI QUY (TR·ªåNG S·ªê) ƒê∆Ø·ª¢C THU TH·∫¨P T·ª™ TH√ç NGHI·ªÜM ---
        const BETA_0 = 1.0;  // Intercept (R·ªßi ro n·ªÅn)
        const BETA_1 = 1.2;  // Tr·ªçng s·ªë G√≥c Nghi√™ng (Angle)
        const BETA_2 = 5.0;  // Tr·ªçng s·ªë T·ªëc ƒê·ªô Thay ƒê·ªïi (RATE) - **TR·ªåNG S·ªê CAO NH·∫§T**
        const BETA_3 = 0.5;  // Tr·ªçng s·ªë T·ªëc ƒê·ªô Gi√≥ (Wind)
        // const BETA_4 = 0.1; // ƒê√£ lo·∫°i b·ªè tr·ªçng s·ªë ƒê·ªô ·∫®m (Humidity)

        const CRITICAL_ANGLE = 20; // Ng∆∞·ª°ng g√≥c nghi√™ng ƒë·ªÉ can thi·ªáp (ƒê·ªô)

        // D·ªØ li·ªáu m√¥ ph·ªèng ban ƒë·∫ßu
        let currentAngle = 1.5; // B·∫Øt ƒë·∫ßu t·ª´ 1.5 ƒë·ªô
        let currentRate = 0.05; // B·∫Øt ƒë·∫ßu t·ª´ 0.05 ƒë·ªô/gi·ªù (R·ªßi ro x√≥i m√≤n ch·∫≠m)
        let simulatedTime = 0; // Gi·∫£ l·∫≠p th·ªùi gian
        const updateIntervalSeconds = 1; // C·∫≠p nh·∫≠t sau m·ªói 1 gi√¢y

        // --- H√ÄM T√çNH TO√ÅN C·ªêT L√ïI (M√¥ h√¨nh H·ªìi quy Tuy·∫øn t√≠nh ƒêa Bi·∫øn) ---
        // ƒê√£ lo·∫°i b·ªè tham s·ªë humidity
        function calculateRiskScore(angle, rate, wind) {
            // Score = B0 + B1*|Œ∏| + B2*Rate + B3*Wind
            const score = BETA_0 + 
                          (BETA_1 * angle) + 
                          (BETA_2 * rate) + 
                          (BETA_3 * wind);
                          // (BETA_4 * humidity) // ƒê√£ lo·∫°i b·ªè
            return score;
        }

        // --- H√ÄM T√çNH TO√ÅN TH·ªúI GIAN C√íN L·∫†I (TIME-TO-INTERVENTION) ---
        function calculateTimeToIntervention(angle, rate) {
            if (rate <= 0) {
                return "AN TO√ÄN | R·ªßi ro gi·∫£m"; // C√¢y ƒëang th·∫≥ng l·∫°i ho·∫∑c ƒë·ª©ng y√™n
            }

            if (angle >= CRITICAL_ANGLE) {
                 return "NGUY HI·ªÇM C·ª∞C ƒê·ªò"; // ƒê√£ v∆∞·ª£t ng∆∞·ª°ng
            }

            // Time = (Ng∆∞·ª°ng - G√≥c hi·ªán t·∫°i) / T·ªëc ƒë·ªô thay ƒë·ªïi
            const timeInHours = (CRITICAL_ANGLE - angle) / rate;

            if (timeInHours < 24) {
                // Hi·ªÉn th·ªã gi·ªù
                const hours = Math.floor(timeInHours);
                const minutes = Math.round((timeInHours - hours) * 60);
                return `${hours} GI·ªú ${minutes} PH√öT`;
            } else if (timeInHours < 720) { // D∆∞·ªõi 30 ng√†y
                // Hi·ªÉn th·ªã ng√†y
                const days = Math.floor(timeInHours / 24);
                return `${days} NG√ÄY`;
            } else {
                return "H∆†N 30 NG√ÄY";
            }
        }

        // --- H√ÄM C·∫¨P NH·∫¨T GIAO DI·ªÜN V√Ä M√î PH·ªéNG D·ªÆ LI·ªÜU ---
        function updateDashboard() {
            // 1. M√î PH·ªéNG D·ªÆ LI·ªÜU TƒÇNG D·∫¶N (Gia l·∫≠p Nguy c∆°)
            simulatedTime += updateIntervalSeconds;
            
            // Gi·∫£ l·∫≠p Angle tƒÉng ch·∫≠m nh∆∞ng ƒë·ªÅu (x√≥i m√≤n)
            currentAngle += (0.005 * updateIntervalSeconds); // TƒÉng 0.005 ƒë·ªô m·ªói gi√¢y m√¥ ph·ªèng
            
            // Gi·∫£ l·∫≠p Rate tƒÉng nhanh h∆°n khi Angle g·∫ßn ng∆∞·ª°ng
            if (currentAngle > 5) {
                currentRate += (0.008 * updateIntervalSeconds); // TƒÉng t·ªëc ƒë·ªô d·ªãch chuy·ªÉn
            }

            // L·∫•y gi√° tr·ªã Wind gi·∫£ l·∫≠p
            const wind = parseFloat(document.getElementById('windValue').textContent);


            // 2. CH·∫†Y M√î H√åNH AI
            // ƒê√£ lo·∫°i b·ªè tham s·ªë humidity
            const riskScore = calculateRiskScore(currentAngle, currentRate, wind);
            const timeRemaining = calculateTimeToIntervention(currentAngle, currentRate);


            // 3. X·ª¨ L√ù GIAO DI·ªÜN V√Ä M√ÄU S·∫ÆC
            let bgColor, emoji, statusText, actionText;

            if (riskScore < 10) {
                // AN TO√ÄN
                bgColor = 'bg-green-600';
                emoji = 'üå≥';
                statusText = 'AN TO√ÄN';
                actionText = 'GI√ÅM S√ÅT TH∆Ø·ªúNG XUY√äN';
            } else if (riskScore >= 10 && riskScore < 20) {
                // R·ª¶I RO TRUNG B√åNH
                bgColor = 'bg-yellow-500';
                emoji = '‚ö†Ô∏è';
                statusText = 'NGUY C∆† CAO';
                actionText = 'KI·ªÇM TRA TH·ª∞C ƒê·ªäA ƒê·ªäNH K·ª≤';
            } else {
                // R·ª¶I RO C·ª∞C K·ª≤ CAO
                bgColor = 'bg-red-600';
                emoji = 'üö®';
                statusText = 'KH·∫®N C·∫§P!';
                actionText = 'B√ÅO ƒê·ªòNG V√Ä C·ª®U H·ªò NGAY L·∫¨P T·ª®C';
            }
            
            // C·∫≠p nh·∫≠t gi√° tr·ªã
            document.getElementById('angleValue').textContent = currentAngle.toFixed(2);
            document.getElementById('rateValue').textContent = currentRate.toFixed(2);
            document.getElementById('riskScoreValue').textContent = riskScore.toFixed(1);
            document.getElementById('timeToIntervention').textContent = timeRemaining;
            
            // C·∫≠p nh·∫≠t m√†u s·∫Øc v√† tr·∫°ng th√°i
            const card = document.getElementById('riskScoreCard');
            card.className = card.className.replace(/bg-\w+-\d+/g, '').trim(); // X√≥a m√†u c≈©
            card.classList.add(bgColor);
            
            document.getElementById('riskLevelEmoji').textContent = emoji;
            document.getElementById('currentStatus').textContent = statusText;
            document.getElementById('suggestedAction').textContent = `H√†nh ƒë·ªông: ${actionText}`;
        }

        // Kh·ªüi ƒë·ªông m√¥ ph·ªèng (C·∫≠p nh·∫≠t sau m·ªói 1000ms = 1 gi√¢y)
        setInterval(updateDashboard, 1000);

        // Ch·∫°y l·∫ßn ƒë·∫ßu
        updateDashboard();

    </script>
</body>
</html>
